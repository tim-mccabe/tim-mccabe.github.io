<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Machine Learning Explainability</title>

  <!-- Bootstrap core CSS -->
  <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom fonts for this template -->
  <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
  <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

  <!-- Custom styles for this template -->
  <link href="css/home_page.css" rel="stylesheet">

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.0-rc.3/dist/leaflet.css" />
  <script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>
  <script src='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-omnivore/v0.3.1/leaflet-omnivore.min.js'></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"></script>

  <!-- Syntax Highlighter -->
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.3.2/styles/default.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.3.2/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

</head>

<body>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
    <div class="container">
      <a class="navbar-brand" href="index.html">Blog</a>
      <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        Menu
        <i class="fas fa-bars" aria-hidden="true"></i>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="index.html">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="about.html">Resume</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/tim-mccabe">GitHub</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://www.linkedin.com/in/tim-mccabe-88a0a091/">LinkedIn</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Page Header -->
  <header class="masthead" style="background-image: url('Images/explainability/Explainable-AI.png')">
    <div class="overlay"></div>
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto">
          <div class="post-heading">
            <h1>Machine Learning Explainability</h1>
            <h2 class="subheading">Insights to AI and ML Models</h2>
            <span class="meta">Posted by
              <a href="#">Tim McCabe</a>
              on November 4, 2020</span>
          </div>
        </div>
      </div>
    </div>
  </header>
  
  <!-- Post Content -->
  <article>
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto">

        <h3>
          Overview
        </h3>

        <p>
          <b>Why is it important?</b> Many people say machine learning models are "black boxes", in the sense that they can make good predictions but you can't understand the logic behind those predictions. 
          This statement is true in the sense that most data scientists don't know how to extract insights from models yet. However, this blog will touch upon techniques to extract 
          the following insights from sophisticated machine learning models.
          <ul>
            <li>What features in the data did the model think are most important?</li>
            <li>For any single prediction from a model, how did each feature in the data affect that particular prediction?</li>
            <li>How does each feature affect the model's predictions in a big-picture sense (what is its typical effect when considered over a large number of possible predictions)?</li>
          </ul>
        </p>

        <p>
          These insights have many uses, including

          <ul>
            <li>Debugging</li>
            <li>Informing feature engineering</li>
            <li>Directing future data collection</li>
            <li>Informing human decision-making</li>
            <li>Building Trust</li>
          </ul>
        </p>

        <p>
          <b>Debugging:</b>
          The world has a lot of unreliable, disorganized and generally dirty data. You add a potential source of errors as you write preprocessing code. 
          Add in the potential for target leakage, and it is the norm rather than the exception to have errors at some point in a real data science project.
        </p>

        <p>
          <b>Informing Feature Engineering:</b>
          Feature engineering is usually the most effective way to improve model accuracy. Feature engineering usually involves repeatedly creating new features using 
          transformations of your raw data or features you have previously created. Sometimes you can go through this process using nothing but intuition about the underlying topic. But you'll need more direction when you have 100s of raw 
          features or when you lack background knowledge about the topic you are working on.
        </p>

        <p>
          <b>Directing Future Data Collection:</b>
          You have no control over datasets you download online. But many businesses and organizations using data science have opportunities to expand what types of data they 
          collect. Collecting new types of data can be expensive or inconvenient, so they only want to do this if they know it will be worthwhile. Model-based insights give you 
          a good understanding of the value of features you currently have, which will help you reason about what new values may be most helpful.
        </p>

        <p>
          <b>Informing Human Decision-Making:</b>
          Some decisions are made automatically by models. Amazon doesn't have humans (or elves) scurry to decide what to show you whenever you go to their website. 
          But many important decisions are made by humans. For these decisions, insights can be more valuable than predictions.
        </p>

        <p>
          <b>Building Trust:</b>
          Many people won't assume they can trust your model for important decisions without verifying some basic facts. This is a smart precaution given the frequency 
          of data errors. In practice, showing insights that fit their general understanding of the problem will help build trust, even among people with little deep 
          knowledge of data science.
        </p>

        <h3>
          Permutation Importance
        </h3>

        <p>
          One of the most basic questions we might ask of a model is: What features have the biggest impact on predictions? This concept is called <b>feature importance</b>. 
          There are multiple ways to measure feature importance. Some approaches answer subtly different versions of the question above. Other approaches have documented shortcomings.
        </p>

        <p>
          <b>Permutation importance:</b> 
          Compared to most other approaches, permutation importance is:
          <ul>
            <li>fast to calculate,</li>
            <li>widely used and understood, and</li>
            <li>consistent with properties we would want a feature importance measure to have.</li>
          </ul>
        </p>

        <p>
          Permutation importance uses models differently than anything you've seen so far, and many people find it confusing at first. So we'll start with an example to make it more 
          concrete.
        </p>

        <p>  
          Consider data with the following format:
        </p>
  
        <img class="img-fluid" src="Images/explainability/permutation_1.png" alt="" id="center">

        <p>
          We want to predict a person's height when they become 20 years old, using data that is available at age 10. Our data includes useful features (height at age 10), 
          features with little predictive power (socks owned), as well as some other features we won't focus on in this explanation. Permutation importance is calculated 
          after a model has been fitted. So we won't change the model or change what predictions we'd get for a given value of height, sock-count, etc. Instead we will ask 
          the following question: If I randomly shuffle a single column of the validation data, leaving the target and all other columns in place, how would that affect the 
          accuracy of predictions in that now-shuffled data?
        </p>

        <img class="img-fluid" src="Images/explainability/permutation_2.png" alt="" id="center">

        <p>
          Randomly re-ordering a single column should cause less accurate predictions, since the resulting data no longer corresponds to anything observed in the real world. 
          Model accuracy especially suffers if we shuffle a column that the model relied on heavily for predictions. In this case, shuffling height at age 10 would cause terrible 
          predictions. If we shuffled socks owned instead, the resulting predictions wouldn't suffer nearly as much.
        </p>

        <p> 
          With this insight, the process is as follows: 
          <ol>
            <li>Get a trained model.</li>
            <li>Shuffle the values in a single column, make predictions using the resulting dataset. Use these predictions and the true target values to calculate how much the loss 
            function suffered from shuffling. That performance deterioration measures the importance of the variable you just shuffled.</li>
            <li>Return the data to the original order (undoing the shuffle from step 2). Now repeat step 2 with the next column in the dataset, until you have calculated the 
            importance of each column.</li>
          </ol>
        </p>

        <p>
          <b>Code Example:</b>
          Our example will use a model that predicts whether a soccer/football team will have the "Man of the Game" winner based on the team's statistics. 
          The "Man of the Game" award is given to the best player in the game. Model-building isn't our current focus, so the cell below loads the data and builds a rudimentary model.
        </p>

        <p>
          <pre><code class="python">
import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier

data = pd.read_csv('data/FIFA 2018 Statistics.csv')
y = (data['Man of the Match'] == "Yes")  # Convert from string "Yes"/"No" to binary
feature_names = [i for i in data.columns if data[i].dtype in [np.int64]]
X = data[feature_names]
train_X, val_X, train_y, val_y = train_test_split(X, y, random_state=1)
my_model = RandomForestClassifier(n_estimators=100, random_state=0).fit(train_X, train_y)
          </code></pre>
        </p>

        <p>
          Here is how to calculate and show importances with the eli5 library:
        </p>

        <p>
          <pre><code class="python">
import eli5
from eli5.sklearn import PermutationImportance

perm = PermutationImportance(my_model, random_state=1).fit(val_X, val_y)
eli5.show_weights(perm, feature_names = val_X.columns.tolist())
          </code></pre>
        </p>

        <h4>
          Output
        </h4>

        <div class="output_html rendered_html output_subarea output_execute_result" id="center">

          <style>
          table.eli5-weights tr:hover {
              filter: brightness(85%);
          }
      </style>
              <table class="eli5-weights eli5-feature-importances" style="border-collapse: collapse; border: none; margin-top: 0em; table-layout: auto;">
          <thead>
          <tr style="border: none;">
              <th style="padding: 0 1em 0 0.5em; text-align: right; border: none;">Weight</th>
              <th style="padding: 0 0.5em 0 0.5em; text-align: left; border: none;">Feature</th>
          </tr>
          </thead>
          <tbody>
          
              <tr style="background-color: hsl(120, 100.00%, 80.00%); border: none;">
                  <td style="padding: 0 1em 0 0.5em; text-align: right; border: none;">
                      0.1750
                      
                          ± 0.0848
                      
                  </td>
                  <td style="padding: 0 0.5em 0 0.5em; text-align: left; border: none;">
                      Goal Scored
                  </td>
              </tr>
          
              <tr style="background-color: hsl(120, 100.00%, 91.68%); border: none;">
                  <td style="padding: 0 1em 0 0.5em; text-align: right; border: none;">
                      0.0500
                      
                          ± 0.0637
                      
                  </td>
                  <td style="padding: 0 0.5em 0 0.5em; text-align: left; border: none;">
                      Distance Covered (Kms)
                  </td>
              </tr>
          
              <tr style="background-color: hsl(120, 100.00%, 92.42%); border: none;">
                  <td style="padding: 0 1em 0 0.5em; text-align: right; border: none;">
                      0.0437
                      
                          ± 0.0637
                      
                  </td>
                  <td style="padding: 0 0.5em 0 0.5em; text-align: left; border: none;">
                      Yellow Card
                  </td>
              </tr>
          
              <tr style="background-color: hsl(120, 100.00%, 95.81%); border: none;">
                  <td style="padding: 0 1em 0 0.5em; text-align: right; border: none;">
                      0.0187
                      
                          ± 0.0500
                      
                  </td>
                  <td style="padding: 0 0.5em 0 0.5em; text-align: left; border: none;">
                      Off-Target
                  </td>
              </tr>
          
              <tr style="background-color: hsl(120, 100.00%, 95.81%); border: none;">
                  <td style="padding: 0 1em 0 0.5em; text-align: right; border: none;">
                      0.0187
                      
                          ± 0.0637
                      
                  </td>
                  <td style="padding: 0 0.5em 0 0.5em; text-align: left; border: none;">
                      Free Kicks
                  </td>
              </tr>
          
              <tr style="background-color: hsl(120, 100.00%, 95.81%); border: none;">
                  <td style="padding: 0 1em 0 0.5em; text-align: right; border: none;">
                      0.0187
                      
                          ± 0.0637
                      
                  </td>
                  <td style="padding: 0 0.5em 0 0.5em; text-align: left; border: none;">
                      Fouls Committed
                  </td>
              </tr>
          
              <tr style="background-color: hsl(120, 100.00%, 96.85%); border: none;">
                  <td style="padding: 0 1em 0 0.5em; text-align: right; border: none;">
                      0.0125
                      
                          ± 0.0637
                      
                  </td>
                  <td style="padding: 0 0.5em 0 0.5em; text-align: left; border: none;">
                      Pass Accuracy %
                  </td>
              </tr>
          
              <tr style="background-color: hsl(120, 100.00%, 96.85%); border: none;">
                  <td style="padding: 0 1em 0 0.5em; text-align: right; border: none;">
                      0.0125
                      
                          ± 0.0306
                      
                  </td>
                  <td style="padding: 0 0.5em 0 0.5em; text-align: left; border: none;">
                      Blocked
                  </td>
              </tr>
          
              <tr style="background-color: hsl(120, 100.00%, 98.06%); border: none;">
                  <td style="padding: 0 1em 0 0.5em; text-align: right; border: none;">
                      0.0063
                      
                          ± 0.0612
                      
                  </td>
                  <td style="padding: 0 0.5em 0 0.5em; text-align: left; border: none;">
                      Saves
                  </td>
              </tr>
          
              <tr style="background-color: hsl(120, 100.00%, 98.06%); border: none;">
                  <td style="padding: 0 1em 0 0.5em; text-align: right; border: none;">
                      0.0063
                      
                          ± 0.0250
                      
                  </td>
                  <td style="padding: 0 0.5em 0 0.5em; text-align: left; border: none;">
                      Ball Possession %
                  </td>
              </tr>
          
              <tr style="background-color: hsl(0, 100.00%, 100.00%); border: none;">
                  <td style="padding: 0 1em 0 0.5em; text-align: right; border: none;">
                      0
                      
                          ± 0.0000
                      
                  </td>
                  <td style="padding: 0 0.5em 0 0.5em; text-align: left; border: none;">
                      Red
                  </td>
              </tr>
          
              <tr style="background-color: hsl(0, 100.00%, 100.00%); border: none;">
                  <td style="padding: 0 1em 0 0.5em; text-align: right; border: none;">
                      0
                      
                          ± 0.0000
                      
                  </td>
                  <td style="padding: 0 0.5em 0 0.5em; text-align: left; border: none;">
                      Yellow &amp; Red
                  </td>
              </tr>
          
              <tr style="background-color: hsl(0, 100.00%, 100.00%); border: none;">
                  <td style="padding: 0 1em 0 0.5em; text-align: right; border: none;">
                      0.0000
                      
                          ± 0.0559
                      
                  </td>
                  <td style="padding: 0 0.5em 0 0.5em; text-align: left; border: none;">
                      On-Target
                  </td>
              </tr>
          
              <tr style="background-color: hsl(0, 100.00%, 98.06%); border: none;">
                  <td style="padding: 0 1em 0 0.5em; text-align: right; border: none;">
                      -0.0063
                      
                          ± 0.0729
                      
                  </td>
                  <td style="padding: 0 0.5em 0 0.5em; text-align: left; border: none;">
                      Offsides
                  </td>
              </tr>
          
              <tr style="background-color: hsl(0, 100.00%, 98.06%); border: none;">
                  <td style="padding: 0 1em 0 0.5em; text-align: right; border: none;">
                      -0.0063
                      
                          ± 0.0919
                      
                  </td>
                  <td style="padding: 0 0.5em 0 0.5em; text-align: left; border: none;">
                      Corners
                  </td>
              </tr>
          
              <tr style="background-color: hsl(0, 100.00%, 98.06%); border: none;">
                  <td style="padding: 0 1em 0 0.5em; text-align: right; border: none;">
                      -0.0063
                      
                          ± 0.0250
                      
                  </td>
                  <td style="padding: 0 0.5em 0 0.5em; text-align: left; border: none;">
                      Goals in PSO
                  </td>
              </tr>
          
              <tr style="background-color: hsl(0, 100.00%, 95.81%); border: none;">
                  <td style="padding: 0 1em 0 0.5em; text-align: right; border: none;">
                      -0.0187
                      
                          ± 0.0306
                      
                  </td>
                  <td style="padding: 0 0.5em 0 0.5em; text-align: left; border: none;">
                      Attempts
                  </td>
              </tr>
          
              <tr style="background-color: hsl(0, 100.00%, 91.68%); border: none;">
                  <td style="padding: 0 1em 0 0.5em; text-align: right; border: none;">
                      -0.0500
                      
                          ± 0.0637
                      
                  </td>
                  <td style="padding: 0 0.5em 0 0.5em; text-align: left; border: none;">
                      Passes
                  </td>
              </tr>
          
          
          </tbody>
      </table>
      </div>

        <p>
          <b>Interpreting Permutation Importances: </b>The values towards the top are the most important features, and those towards the bottom matter least. The first number in each row shows 
          how much model performance decreased with a random shuffling (in this case, using "accuracy" as the performance metric). Like most things in data science, there is some randomness 
          to the exact performance change from a shuffling a column. We measure the amount of randomness in our permutation importance calculation by repeating the process with multiple 
          shuffles. The number after the <b>±</b> measures how performance varied from one-reshuffling to the next. 
        </p>

        <p>
          You'll occasionally see negative values for permutation importances. In those cases, 
          the predictions on the shuffled (or noisy) data happened to be more accurate than the real data. This happens when the feature didn't matter (should have had an importance close to 0), 
          but random chance caused the predictions on shuffled data to be more accurate. This is more common with small datasets, like the one in this example, because there is more room for 
          luck/chance. In our example, the most important feature was <b>Goals scored</b>. That seems sensible. Soccer fans may have some intuition about whether the orderings of other variables are 
          surprising or not.
        </p>

        <h3>
          Partial Dependence Plots
        </h3>

        <p>
          While feature importance shows what variables most affect predictions, partial dependence plots show how a feature affects predictions.
        </p>

        <p>
          This is useful to answer questions like:
          <ul>
            <li>Controlling for all other house features, what impact do longitude and latitude have on home prices? To restate this, how would similarly sized houses be priced in different areas?</li>
            <li>Are predicted health differences between two groups due to differences in their diets, or due to some other factor?</li>
          </ul>
          If you are familiar with linear or logistic regression models, partial dependence plots can be interpreted similarly to the coefficients in those models. Though, partial dependence plots on sophisticated models can capture more complex patterns than coefficients from simple models.
        </p>

        <p>
          <b>How it Works: </b>Like permutation importance, partial dependence plots are calculated after a model has been fit. The model is fit on real data that has not been 
          artificially manipulated in any way. In our soccer example, teams may differ in many ways. How many passes they made, shots they took, goals they scored, etc. At first 
          glance, it seems difficult to disentangle the effect of these features. To see how partial plots separate out the effect of each feature, we start by considering a single 
          row of data. For example, that row of data might represent a team that had the ball 50% of the time, made 100 passes, took 10 shots and scored 1 goal.
        </p>

        <p>
          We will use the fitted model to predict our outcome (probability their player won "man of the match"). But we repeatedly alter the value for one variable to make a series 
          of predictions. We could predict the outcome if the team had the ball only 40% of the time. We then predict with them having the ball 50% of the time. Then predict again 
          for 60%. And so on. We trace out predicted outcomes (on the vertical axis) as we move from small values of ball possession to large values (on the horizontal axis). In this 
          description, we used only a single row of data. Interactions between features may cause the plot for a single row to be atypical. So, we repeat that mental experiment with 
          multiple rows from the original dataset, and we plot the average predicted outcome on the vertical axis.
        </p>

        <p>
          Our first example uses a decision tree, which you can see below. In practice, you'll use more sophistated models for real-world applications.
        </p>

        <p>
          <pre><code class="python">
from sklearn import tree
import graphviz

tree_graph = tree.export_graphviz(tree_model, out_file=None, feature_names=feature_names)
graphviz.Source(tree_graph)
          </code></pre>
        </p>

        <div class="output_wrapper" id="center">
          <div class="output">
          
          
          <div class="output_area">
          
              <div class="prompt output_prompt">Out[2]:</div>
          
          
          
          <div class="output_svg output_subarea output_execute_result">
          <!--?xml version="1.0" encoding="UTF-8" standalone="no"?-->
          
          <!-- Generated by graphviz version 2.42.3 (20191010.1750)
           -->
          <!-- Title: Tree Pages: 1 -->
          <svg width="806pt" height="581pt" viewBox="0.00 0.00 806.00 581.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 577)">
          <title>Tree</title>
          <polygon fill="white" stroke="transparent" points="-4,4 -4,-577 802,-577 802,4 -4,4"></polygon>
          <!-- 0 -->
          <g id="node1" class="node">
          <title>0</title>
          <polygon fill="none" stroke="black" points="371.5,-573 246.5,-573 246.5,-505 371.5,-505 371.5,-573"></polygon>
          <text text-anchor="middle" x="309" y="-557.8" font-family="Times,serif" font-size="14.00">Goal Scored &lt;= 0.5</text>
          <text text-anchor="middle" x="309" y="-542.8" font-family="Times,serif" font-size="14.00">gini = 0.5</text>
          <text text-anchor="middle" x="309" y="-527.8" font-family="Times,serif" font-size="14.00">samples = 96</text>
          <text text-anchor="middle" x="309" y="-512.8" font-family="Times,serif" font-size="14.00">value = [48, 48]</text>
          </g>
          <!-- 1 -->
          <g id="node2" class="node">
          <title>1</title>
          <polygon fill="none" stroke="black" points="300,-469 186,-469 186,-401 300,-401 300,-469"></polygon>
          <text text-anchor="middle" x="243" y="-453.8" font-family="Times,serif" font-size="14.00">On-Target &lt;= 7.5</text>
          <text text-anchor="middle" x="243" y="-438.8" font-family="Times,serif" font-size="14.00">gini = 0.142</text>
          <text text-anchor="middle" x="243" y="-423.8" font-family="Times,serif" font-size="14.00">samples = 26</text>
          <text text-anchor="middle" x="243" y="-408.8" font-family="Times,serif" font-size="14.00">value = [24, 2]</text>
          </g>
          <!-- 0&#45;&gt;1 -->
          <g id="edge1" class="edge">
          <title>0-&gt;1</title>
          <path fill="none" stroke="black" d="M287.57,-504.88C281.98,-496.24 275.88,-486.82 270.04,-477.79"></path>
          <polygon fill="black" stroke="black" points="272.92,-475.79 264.55,-469.3 267.04,-479.6 272.92,-475.79"></polygon>
          <text text-anchor="middle" x="259.31" y="-490.04" font-family="Times,serif" font-size="14.00">True</text>
          </g>
          <!-- 6 -->
          <g id="node7" class="node">
          <title>6</title>
          <polygon fill="none" stroke="black" points="433.5,-469 318.5,-469 318.5,-401 433.5,-401 433.5,-469"></polygon>
          <text text-anchor="middle" x="376" y="-453.8" font-family="Times,serif" font-size="14.00">Attempts &lt;= 24.0</text>
          <text text-anchor="middle" x="376" y="-438.8" font-family="Times,serif" font-size="14.00">gini = 0.451</text>
          <text text-anchor="middle" x="376" y="-423.8" font-family="Times,serif" font-size="14.00">samples = 70</text>
          <text text-anchor="middle" x="376" y="-408.8" font-family="Times,serif" font-size="14.00">value = [24, 46]</text>
          </g>
          <!-- 0&#45;&gt;6 -->
          <g id="edge6" class="edge">
          <title>0-&gt;6</title>
          <path fill="none" stroke="black" d="M330.75,-504.88C336.43,-496.24 342.62,-486.82 348.55,-477.79"></path>
          <polygon fill="black" stroke="black" points="351.56,-479.58 354.13,-469.3 345.71,-475.74 351.56,-479.58"></polygon>
          <text text-anchor="middle" x="359.2" y="-490.08" font-family="Times,serif" font-size="14.00">False</text>
          </g>
          <!-- 2 -->
          <g id="node3" class="node">
          <title>2</title>
          <polygon fill="none" stroke="black" points="182.5,-365 75.5,-365 75.5,-297 182.5,-297 182.5,-365"></polygon>
          <text text-anchor="middle" x="129" y="-349.8" font-family="Times,serif" font-size="14.00">Passes &lt;= 634.0</text>
          <text text-anchor="middle" x="129" y="-334.8" font-family="Times,serif" font-size="14.00">gini = 0.077</text>
          <text text-anchor="middle" x="129" y="-319.8" font-family="Times,serif" font-size="14.00">samples = 25</text>
          <text text-anchor="middle" x="129" y="-304.8" font-family="Times,serif" font-size="14.00">value = [24, 1]</text>
          </g>
          <!-- 1&#45;&gt;2 -->
          <g id="edge2" class="edge">
          <title>1-&gt;2</title>
          <path fill="none" stroke="black" d="M205.99,-400.88C195.73,-391.71 184.49,-381.65 173.84,-372.12"></path>
          <polygon fill="black" stroke="black" points="176,-369.36 166.22,-365.3 171.34,-374.58 176,-369.36"></polygon>
          </g>
          <!-- 5 -->
          <g id="node6" class="node">
          <title>5</title>
          <polygon fill="none" stroke="black" points="293,-357.5 201,-357.5 201,-304.5 293,-304.5 293,-357.5"></polygon>
          <text text-anchor="middle" x="247" y="-342.3" font-family="Times,serif" font-size="14.00">gini = 0.0</text>
          <text text-anchor="middle" x="247" y="-327.3" font-family="Times,serif" font-size="14.00">samples = 1</text>
          <text text-anchor="middle" x="247" y="-312.3" font-family="Times,serif" font-size="14.00">value = [0, 1]</text>
          </g>
          <!-- 1&#45;&gt;5 -->
          <g id="edge5" class="edge">
          <title>1-&gt;5</title>
          <path fill="none" stroke="black" d="M244.3,-400.88C244.72,-390.22 245.18,-378.35 245.61,-367.52"></path>
          <polygon fill="black" stroke="black" points="249.1,-367.65 246,-357.52 242.11,-367.38 249.1,-367.65"></polygon>
          </g>
          <!-- 3 -->
          <g id="node4" class="node">
          <title>3</title>
          <polygon fill="none" stroke="black" points="98,-253.5 0,-253.5 0,-200.5 98,-200.5 98,-253.5"></polygon>
          <text text-anchor="middle" x="49" y="-238.3" font-family="Times,serif" font-size="14.00">gini = 0.0</text>
          <text text-anchor="middle" x="49" y="-223.3" font-family="Times,serif" font-size="14.00">samples = 23</text>
          <text text-anchor="middle" x="49" y="-208.3" font-family="Times,serif" font-size="14.00">value = [23, 0]</text>
          </g>
          <!-- 2&#45;&gt;3 -->
          <g id="edge3" class="edge">
          <title>2-&gt;3</title>
          <path fill="none" stroke="black" d="M103.03,-296.88C94.14,-285.56 84.2,-272.88 75.29,-261.52"></path>
          <polygon fill="black" stroke="black" points="77.94,-259.23 69.02,-253.52 72.43,-263.55 77.94,-259.23"></polygon>
          </g>
          <!-- 4 -->
          <g id="node5" class="node">
          <title>4</title>
          <polygon fill="none" stroke="black" points="208,-253.5 116,-253.5 116,-200.5 208,-200.5 208,-253.5"></polygon>
          <text text-anchor="middle" x="162" y="-238.3" font-family="Times,serif" font-size="14.00">gini = 0.5</text>
          <text text-anchor="middle" x="162" y="-223.3" font-family="Times,serif" font-size="14.00">samples = 2</text>
          <text text-anchor="middle" x="162" y="-208.3" font-family="Times,serif" font-size="14.00">value = [1, 1]</text>
          </g>
          <!-- 2&#45;&gt;4 -->
          <g id="edge4" class="edge">
          <title>2-&gt;4</title>
          <path fill="none" stroke="black" d="M139.71,-296.88C143.2,-286.11 147.08,-274.11 150.62,-263.18"></path>
          <polygon fill="black" stroke="black" points="154,-264.11 153.74,-253.52 147.34,-261.96 154,-264.11"></polygon>
          </g>
          <!-- 7 -->
          <g id="node8" class="node">
          <title>7</title>
          <polygon fill="none" stroke="black" points="424.5,-365 319.5,-365 319.5,-297 424.5,-297 424.5,-365"></polygon>
          <text text-anchor="middle" x="372" y="-349.8" font-family="Times,serif" font-size="14.00">Corners &lt;= 4.5</text>
          <text text-anchor="middle" x="372" y="-334.8" font-family="Times,serif" font-size="14.00">gini = 0.43</text>
          <text text-anchor="middle" x="372" y="-319.8" font-family="Times,serif" font-size="14.00">samples = 67</text>
          <text text-anchor="middle" x="372" y="-304.8" font-family="Times,serif" font-size="14.00">value = [21, 46]</text>
          </g>
          <!-- 6&#45;&gt;7 -->
          <g id="edge7" class="edge">
          <title>6-&gt;7</title>
          <path fill="none" stroke="black" d="M374.7,-400.88C374.38,-392.78 374.04,-383.98 373.7,-375.47"></path>
          <polygon fill="black" stroke="black" points="377.2,-375.15 373.31,-365.3 370.2,-375.43 377.2,-375.15"></polygon>
          </g>
          <!-- 20 -->
          <g id="node21" class="node">
          <title>20</title>
          <polygon fill="none" stroke="black" points="535,-357.5 443,-357.5 443,-304.5 535,-304.5 535,-357.5"></polygon>
          <text text-anchor="middle" x="489" y="-342.3" font-family="Times,serif" font-size="14.00">gini = 0.0</text>
          <text text-anchor="middle" x="489" y="-327.3" font-family="Times,serif" font-size="14.00">samples = 3</text>
          <text text-anchor="middle" x="489" y="-312.3" font-family="Times,serif" font-size="14.00">value = [3, 0]</text>
          </g>
          <!-- 6&#45;&gt;20 -->
          <g id="edge20" class="edge">
          <title>6-&gt;20</title>
          <path fill="none" stroke="black" d="M412.69,-400.88C425.6,-389.23 440.1,-376.14 452.96,-364.53"></path>
          <polygon fill="black" stroke="black" points="455.65,-366.82 460.73,-357.52 450.96,-361.62 455.65,-366.82"></polygon>
          </g>
          <!-- 8 -->
          <g id="node9" class="node">
          <title>8</title>
          <polygon fill="none" stroke="black" points="397.5,-261 282.5,-261 282.5,-193 397.5,-193 397.5,-261"></polygon>
          <text text-anchor="middle" x="340" y="-245.8" font-family="Times,serif" font-size="14.00">Attempts &lt;= 12.5</text>
          <text text-anchor="middle" x="340" y="-230.8" font-family="Times,serif" font-size="14.00">gini = 0.499</text>
          <text text-anchor="middle" x="340" y="-215.8" font-family="Times,serif" font-size="14.00">samples = 31</text>
          <text text-anchor="middle" x="340" y="-200.8" font-family="Times,serif" font-size="14.00">value = [15, 16]</text>
          </g>
          <!-- 7&#45;&gt;8 -->
          <g id="edge8" class="edge">
          <title>7-&gt;8</title>
          <path fill="none" stroke="black" d="M361.61,-296.88C359.01,-288.6 356.19,-279.6 353.46,-270.91"></path>
          <polygon fill="black" stroke="black" points="356.78,-269.79 350.45,-261.3 350.1,-271.89 356.78,-269.79"></polygon>
          </g>
          <!-- 13 -->
          <g id="node14" class="node">
          <title>13</title>
          <polygon fill="none" stroke="black" points="622.5,-261 415.5,-261 415.5,-193 622.5,-193 622.5,-261"></polygon>
          <text text-anchor="middle" x="519" y="-245.8" font-family="Times,serif" font-size="14.00">Distance Covered (Kms) &lt;= 101.5</text>
          <text text-anchor="middle" x="519" y="-230.8" font-family="Times,serif" font-size="14.00">gini = 0.278</text>
          <text text-anchor="middle" x="519" y="-215.8" font-family="Times,serif" font-size="14.00">samples = 36</text>
          <text text-anchor="middle" x="519" y="-200.8" font-family="Times,serif" font-size="14.00">value = [6, 30]</text>
          </g>
          <!-- 7&#45;&gt;13 -->
          <g id="edge13" class="edge">
          <title>7-&gt;13</title>
          <path fill="none" stroke="black" d="M419.73,-296.88C433.53,-287.3 448.73,-276.76 462.99,-266.86"></path>
          <polygon fill="black" stroke="black" points="465.04,-269.7 471.26,-261.12 461.05,-263.95 465.04,-269.7"></polygon>
          </g>
          <!-- 9 -->
          <g id="node10" class="node">
          <title>9</title>
          <polygon fill="none" stroke="black" points="290.5,-157 165.5,-157 165.5,-89 290.5,-89 290.5,-157"></polygon>
          <text text-anchor="middle" x="228" y="-141.8" font-family="Times,serif" font-size="14.00">Goal Scored &lt;= 3.5</text>
          <text text-anchor="middle" x="228" y="-126.8" font-family="Times,serif" font-size="14.00">gini = 0.488</text>
          <text text-anchor="middle" x="228" y="-111.8" font-family="Times,serif" font-size="14.00">samples = 26</text>
          <text text-anchor="middle" x="228" y="-96.8" font-family="Times,serif" font-size="14.00">value = [15, 11]</text>
          </g>
          <!-- 8&#45;&gt;9 -->
          <g id="edge9" class="edge">
          <title>8-&gt;9</title>
          <path fill="none" stroke="black" d="M303.64,-192.88C293.56,-183.71 282.52,-173.65 272.06,-164.12"></path>
          <polygon fill="black" stroke="black" points="274.31,-161.44 264.56,-157.3 269.6,-166.62 274.31,-161.44"></polygon>
          </g>
          <!-- 12 -->
          <g id="node13" class="node">
          <title>12</title>
          <polygon fill="none" stroke="black" points="401,-149.5 309,-149.5 309,-96.5 401,-96.5 401,-149.5"></polygon>
          <text text-anchor="middle" x="355" y="-134.3" font-family="Times,serif" font-size="14.00">gini = 0.0</text>
          <text text-anchor="middle" x="355" y="-119.3" font-family="Times,serif" font-size="14.00">samples = 5</text>
          <text text-anchor="middle" x="355" y="-104.3" font-family="Times,serif" font-size="14.00">value = [0, 5]</text>
          </g>
          <!-- 8&#45;&gt;12 -->
          <g id="edge12" class="edge">
          <title>8-&gt;12</title>
          <path fill="none" stroke="black" d="M344.87,-192.88C346.44,-182.22 348.18,-170.35 349.78,-159.52"></path>
          <polygon fill="black" stroke="black" points="353.25,-159.92 351.25,-149.52 346.33,-158.9 353.25,-159.92"></polygon>
          </g>
          <!-- 10 -->
          <g id="node11" class="node">
          <title>10</title>
          <polygon fill="none" stroke="black" points="200,-53 102,-53 102,0 200,0 200,-53"></polygon>
          <text text-anchor="middle" x="151" y="-37.8" font-family="Times,serif" font-size="14.00">gini = 0.454</text>
          <text text-anchor="middle" x="151" y="-22.8" font-family="Times,serif" font-size="14.00">samples = 23</text>
          <text text-anchor="middle" x="151" y="-7.8" font-family="Times,serif" font-size="14.00">value = [15, 8]</text>
          </g>
          <!-- 9&#45;&gt;10 -->
          <g id="edge10" class="edge">
          <title>9-&gt;10</title>
          <path fill="none" stroke="black" d="M201.07,-88.95C193.76,-79.98 185.85,-70.27 178.51,-61.26"></path>
          <polygon fill="black" stroke="black" points="181,-58.78 171.97,-53.24 175.57,-63.2 181,-58.78"></polygon>
          </g>
          <!-- 11 -->
          <g id="node12" class="node">
          <title>11</title>
          <polygon fill="none" stroke="black" points="310,-53 218,-53 218,0 310,0 310,-53"></polygon>
          <text text-anchor="middle" x="264" y="-37.8" font-family="Times,serif" font-size="14.00">gini = 0.0</text>
          <text text-anchor="middle" x="264" y="-22.8" font-family="Times,serif" font-size="14.00">samples = 3</text>
          <text text-anchor="middle" x="264" y="-7.8" font-family="Times,serif" font-size="14.00">value = [0, 3]</text>
          </g>
          <!-- 9&#45;&gt;11 -->
          <g id="edge11" class="edge">
          <title>9-&gt;11</title>
          <path fill="none" stroke="black" d="M240.59,-88.95C243.83,-80.44 247.33,-71.26 250.61,-62.65"></path>
          <polygon fill="black" stroke="black" points="253.91,-63.83 254.2,-53.24 247.36,-61.34 253.91,-63.83"></polygon>
          </g>
          <!-- 14 -->
          <g id="node15" class="node">
          <title>14</title>
          <polygon fill="none" stroke="black" points="563,-157 447,-157 447,-89 563,-89 563,-157"></polygon>
          <text text-anchor="middle" x="505" y="-141.8" font-family="Times,serif" font-size="14.00">Off-Target &lt;= 7.5</text>
          <text text-anchor="middle" x="505" y="-126.8" font-family="Times,serif" font-size="14.00">gini = 0.49</text>
          <text text-anchor="middle" x="505" y="-111.8" font-family="Times,serif" font-size="14.00">samples = 7</text>
          <text text-anchor="middle" x="505" y="-96.8" font-family="Times,serif" font-size="14.00">value = [3, 4]</text>
          </g>
          <!-- 13&#45;&gt;14 -->
          <g id="edge14" class="edge">
          <title>13-&gt;14</title>
          <path fill="none" stroke="black" d="M514.45,-192.88C513.34,-184.78 512.13,-175.98 510.97,-167.47"></path>
          <polygon fill="black" stroke="black" points="514.4,-166.73 509.57,-157.3 507.46,-167.68 514.4,-166.73"></polygon>
          </g>
          <!-- 17 -->
          <g id="node18" class="node">
          <title>17</title>
          <polygon fill="none" stroke="black" points="705,-157 581,-157 581,-89 705,-89 705,-157"></polygon>
          <text text-anchor="middle" x="643" y="-141.8" font-family="Times,serif" font-size="14.00">Free Kicks &lt;= 10.5</text>
          <text text-anchor="middle" x="643" y="-126.8" font-family="Times,serif" font-size="14.00">gini = 0.185</text>
          <text text-anchor="middle" x="643" y="-111.8" font-family="Times,serif" font-size="14.00">samples = 29</text>
          <text text-anchor="middle" x="643" y="-96.8" font-family="Times,serif" font-size="14.00">value = [3, 26]</text>
          </g>
          <!-- 13&#45;&gt;17 -->
          <g id="edge17" class="edge">
          <title>13-&gt;17</title>
          <path fill="none" stroke="black" d="M559.26,-192.88C570.52,-183.62 582.88,-173.45 594.56,-163.85"></path>
          <polygon fill="black" stroke="black" points="597.02,-166.36 602.52,-157.3 592.57,-160.95 597.02,-166.36"></polygon>
          </g>
          <!-- 15 -->
          <g id="node16" class="node">
          <title>15</title>
          <polygon fill="none" stroke="black" points="448,-53 356,-53 356,0 448,0 448,-53"></polygon>
          <text text-anchor="middle" x="402" y="-37.8" font-family="Times,serif" font-size="14.00">gini = 0.0</text>
          <text text-anchor="middle" x="402" y="-22.8" font-family="Times,serif" font-size="14.00">samples = 4</text>
          <text text-anchor="middle" x="402" y="-7.8" font-family="Times,serif" font-size="14.00">value = [0, 4]</text>
          </g>
          <!-- 14&#45;&gt;15 -->
          <g id="edge15" class="edge">
          <title>14-&gt;15</title>
          <path fill="none" stroke="black" d="M468.98,-88.95C458.81,-79.62 447.75,-69.47 437.6,-60.16"></path>
          <polygon fill="black" stroke="black" points="439.79,-57.42 430.05,-53.24 435.05,-62.58 439.79,-57.42"></polygon>
          </g>
          <!-- 16 -->
          <g id="node17" class="node">
          <title>16</title>
          <polygon fill="none" stroke="black" points="558,-53 466,-53 466,0 558,0 558,-53"></polygon>
          <text text-anchor="middle" x="512" y="-37.8" font-family="Times,serif" font-size="14.00">gini = 0.0</text>
          <text text-anchor="middle" x="512" y="-22.8" font-family="Times,serif" font-size="14.00">samples = 3</text>
          <text text-anchor="middle" x="512" y="-7.8" font-family="Times,serif" font-size="14.00">value = [3, 0]</text>
          </g>
          <!-- 14&#45;&gt;16 -->
          <g id="edge16" class="edge">
          <title>14-&gt;16</title>
          <path fill="none" stroke="black" d="M507.45,-88.95C508.06,-80.72 508.71,-71.85 509.33,-63.48"></path>
          <polygon fill="black" stroke="black" points="512.85,-63.47 510.09,-53.24 505.86,-62.95 512.85,-63.47"></polygon>
          </g>
          <!-- 18 -->
          <g id="node19" class="node">
          <title>18</title>
          <polygon fill="none" stroke="black" points="682,-53 590,-53 590,0 682,0 682,-53"></polygon>
          <text text-anchor="middle" x="636" y="-37.8" font-family="Times,serif" font-size="14.00">gini = 0.48</text>
          <text text-anchor="middle" x="636" y="-22.8" font-family="Times,serif" font-size="14.00">samples = 5</text>
          <text text-anchor="middle" x="636" y="-7.8" font-family="Times,serif" font-size="14.00">value = [2, 3]</text>
          </g>
          <!-- 17&#45;&gt;18 -->
          <g id="edge18" class="edge">
          <title>17-&gt;18</title>
          <path fill="none" stroke="black" d="M640.55,-88.95C639.94,-80.72 639.29,-71.85 638.67,-63.48"></path>
          <polygon fill="black" stroke="black" points="642.14,-62.95 637.91,-53.24 635.15,-63.47 642.14,-62.95"></polygon>
          </g>
          <!-- 19 -->
          <g id="node20" class="node">
          <title>19</title>
          <polygon fill="none" stroke="black" points="798,-53 700,-53 700,0 798,0 798,-53"></polygon>
          <text text-anchor="middle" x="749" y="-37.8" font-family="Times,serif" font-size="14.00">gini = 0.08</text>
          <text text-anchor="middle" x="749" y="-22.8" font-family="Times,serif" font-size="14.00">samples = 24</text>
          <text text-anchor="middle" x="749" y="-7.8" font-family="Times,serif" font-size="14.00">value = [1, 23]</text>
          </g>
          <!-- 17&#45;&gt;19 -->
          <g id="edge19" class="edge">
          <title>17-&gt;19</title>
          <path fill="none" stroke="black" d="M680.07,-88.95C690.54,-79.62 701.92,-69.47 712.36,-60.16"></path>
          <polygon fill="black" stroke="black" points="715,-62.5 720.13,-53.24 710.34,-57.28 715,-62.5"></polygon>
          </g>
          </g>
          </svg>
          
          </div>
          
          </div>
          
          </div>
          </div>

        <p>
          As guidance to read the tree:
          <ul>
            <li>Leaves with children show their splitting criterion on the top</li>
            <li>The pair of values at the bottom show the count of False values and True values for the target respectively, of data points in that node of the tree.</li>
          </ul>
        </p>

        <p>
          Here is the code to create the Partial Dependence Plot using the PDPBox library.
        </p>

        <p>
          <pre><code class="python">
from matplotlib import pyplot as plt
from pdpbox import pdp, get_dataset, info_plots

# Build Random Forest model
rf_model = RandomForestClassifier(random_state=0).fit(train_X, train_y)

# Create the data that we will plot
pdp_dist = pdp.pdp_isolate(model=rf_model, dataset=val_X, model_features=feature_names, feature=feature_to_plot)

# plot it
pdp.pdp_plot(pdp_dist, feature_to_plot)
plt.show()
          </code></pre>
        </p>

        <img class="img-fluid" src="Images/explainability/partial_plot_1.png" alt="" id="center">

        <h3>
          SHAP Values
        </h3>

        <p>
          SHAP Values (an acronym from SHapley Additive exPlanations) break down a prediction to show the impact of each feature. Where could you use this?
          <ul>
            <li>A model says a bank shouldn't loan someone money, and the bank is legally required to explain the basis for each loan rejection</li>
            <li>A healthcare provider wants to identify what factors are driving each patient's risk of some disease so they can directly address those risk factors with targeted health interventions</li>
          </ul>
        </p>

        <p>
          <b>How They Work: </b>
          SHAP values interpret the impact of having a certain value for a given feature in comparison to the prediction we'd make if that feature took some baseline value.
        </p>

        <p>
          We could ask:
          <ul>
            <li>How much was a prediction driven by the fact that the team scored 3 goals?</li>
          </ul>

          But it's easier to give a concrete, numeric answer if we restate this as:
          <ul>
            <li>How much was a prediction driven by the fact that the team scored 3 goals, instead of some baseline number of goals.</li>
          </ul>

          Of course, each team has many features. So if we answer this question for number of goals, we could repeat the process for all other features. SHAP values do this in a way 
          that guarantees a nice property. Specifically, you decompose a prediction with the following equation: sum(SHAP values for all features) = pred_for_team - pred_for_baseline_values 
          That is, the SHAP values of all features sum up to explain why my prediction was different from the baseline. This allows us to decompose a prediction in a graph like this:
        </p>

        <img class="img-fluid" src="Images/explainability/shap_1.png" alt="" id="center">

        <p>
          <b>How do you interpret this? </b>We predicted 0.7, whereas the base_value is 0.4979. Feature values causing increased predictions are in pink, and their visual size shows 
          the magnitude of the feature's effect. Feature values decreasing the prediction are in blue. The biggest impact comes from Goal Scored being 2. Though the ball possession 
          value has a meaningful effect decreasing the prediction. If you subtract the length of the blue bars from the length of the pink bars, it equals the distance from the base 
          value to the output. There is some complexity to the technique, to ensure that the baseline plus the sum of individual effects adds up to the prediction (which isn't as 
          straightforward as it sounds).
        </p>

        <p>
          <b>Code to Calculate SHAP Values: </b>
          We calculate SHAP values using the wonderful Shap library.
        </p>

        <p>
          <pre><code class="python">
import shap  # package used to calculate Shap values

# Create object that can calculate shap values
explainer = shap.TreeExplainer(my_model)

# Calculate Shap values
shap_values = explainer.shap_values(data_for_prediction)
          </code></pre>
        </p>

        <p>
          The shap_values object above is a list with two arrays. The first array is the SHAP values for a negative outcome (don't win the award), and the second array is the list 
          of SHAP values for the positive outcome (wins the award). We typically think about predictions in terms of the prediction of a positive outcome, so we'll pull out SHAP 
          values for positive outcomes (pulling out shap_values[1]).

          It's cumbersome to review raw arrays, but the shap package has a nice way to visualize the results.
        </p>

        <p>
          <pre><code class="python">
shap.initjs()
shap.force_plot(explainer.expected_value[1], shap_values[1], data_for_prediction)
          </code></pre>
        </p>

        <img class="img-fluid" src="Images/explainability/shap_2.png" alt="" id="center">

        <h3>
          Summary Plots
        </h3>

        <p>
          Permutation importance is great because it created simple numeric measures to see which features mattered to a model. This helped us make comparisons between features easily, 
          and you can present the resulting graphs to non-technical audiences.
          But it doesn't tell you how each features matter. If a feature has medium permutation importance, that could mean it has
          <ul>
            <li>a large effect for a few predictions, but no effect in general, or</li>
            <li>a medium effect for all predictions.</li>
          </ul>
          SHAP summary plots give us a birds-eye view of feature importance and what is driving it.
        </p>

        <img class="img-fluid" src="Images/explainability/summary_plot_1.png" alt="" id="center">

        <p>
          This plot is made of many dots. Each dot has three characteristics:
          <ul>
            <li>Vertical location shows what feature it is depicting</li>
            <li>Color shows whether that feature was high or low for that row of the dataset</li>
            <li>Horizontal location shows whether the effect of that value caused a higher or lower prediction.</li>
          </ul>
          For example, the point in the upper left was for a team that scored few goals, reducing the prediction by 0.25.
          <br>
          <br>
          Some things you should be able to easily pick out:
          <ul>
            <li>The model ignored the Red and Yellow & Red features.</li>
            <li>Usually Yellow Card doesn't affect the prediction, but there is an extreme case where a high value caused a much lower prediction.</li>
            <li>High values of Goal scored caused higher predictions, and low values caused low predictions</li>
          </ul>
        </p>

        <p><b>Summary Plots in Code: </b></p>

        <p>
          <pre><code class="python">
import shap  # package used to calculate Shap values

# Create object that can calculate shap values
explainer = shap.TreeExplainer(my_model)

# calculate shap values. This is what we will plot.
# Calculate shap_values for all of val_X rather than a single row, to have more data for plot.
shap_values = explainer.shap_values(val_X)

# Make plot. Index of [1] is explained in text below.
shap.summary_plot(shap_values[1], val_X)
          </code></pre>
        </p>

        <p>Data and Info Source by 
            <a href="https://www.kaggle.com/learn/machine-learning-explainability">Kaggle Machine Learning Explainability</a>.</p>
        </div>
      </div>
    </div>
  </article>

  <hr>

  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto">
          <ul class="list-inline text-center">
            <li class="list-inline-item">
              <a href="https://www.kaggle.com/timmccabe">
                <span class="fa-stack fa-lg">
                  <i class="fas fa-circle fa-stack-2x"></i>
                  <i class="fab fa-kaggle fa-stack-1x fa-inverse"></i>
                </span>
              </a>
            </li>
            <li class="list-inline-item">
              <a href="https://www.linkedin.com/in/tim-mccabe-88a0a091/">
                <span class="fa-stack fa-lg">
                  <i class="fas fa-circle fa-stack-2x"></i>
                  <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                </span>
              </a>
            </li>
            <li class="list-inline-item">
              <a href="https://github.com/tim-mccabe">
                <span class="fa-stack fa-lg">
                  <i class="fas fa-circle fa-stack-2x"></i>
                  <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                </span>
              </a>
            </li>
          </ul>
          <p class="copyright text-muted">Copyright © Tim McCabe</p>
        </div>
      </div>
    </div>
  </footer>

  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  <!-- Custom scripts for this template -->
  <script src="js/home_page.js"></script>

  <!-- Our JS -->


</body>

</html>